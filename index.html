<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Labour Link</title>
  <style>
    /* Professional theme variables */
    :root{
      --bg: linear-gradient(180deg,#f4f7fb,#eef3f8); /* subtle cool background */
      --card: #ffffff; /* card surface */
      --card-2: #f7fbfd; /* slightly tinted card */
      --text: #0f1724; /* primary text (dark navy) */
      --muted: #53607a; /* muted text */
      --accent: #0b63d6; /* primary accent - deep blue */
      --accent-2: #06b6d4; /* secondary accent - teal */
      --dark: #0b1220; /* deep background/dark */
      --tag-bg: rgba(11,99,214,0.08);
      --btn-text: #ffffff;
      --btn-radius:10px;
      --shadow-lg: 0 18px 40px rgba(11,18,34,0.08);
      --shadow-md: 0 8px 20px rgba(11,18,34,0.06);
    }

    /* Base layout */
  body{font-family:Inter, system-ui, Arial; color:var(--text); background:var(--bg); margin:0; padding:24px}
  .container{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:20px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(20,20,30,0.06)}
    h2{margin:0 0 12px;font-size:18px}
    label{display:block;font-size:13px;margin:10px 0 6px}
    /* Textbox base styles */
    input, select, textarea{
      width:100%;
      padding:10px;
      border:1px solid rgba(14,22,34,0.06);
      border-radius:8px;
      font-size:14px;
      background: linear-gradient(180deg,var(--card),var(--card-2));
      background-size:140% 140%;
      transition: box-shadow .22s cubic-bezier(.2,.9,.3,1), transform .18s ease, border-color .18s ease, background-position .6s ease;
      box-shadow: var(--shadow-md);
      -webkit-appearance:none; -moz-appearance:none; appearance:none;
    }

    /* Hover: subtle lift and soft border change */
    input:hover, select:hover, textarea:hover{
      transform: translateY(-2px);
      box-shadow: 0 10px 28px rgba(37,99,235,0.06);
      border-color: rgba(37,99,235,0.45);
      background-position: 0% 24%;
    }

    /* Focus: stronger glow and clearer border */
    input:focus, select:focus, textarea:focus{
      outline: none;
      transform: translateY(-3px);
      box-shadow: 0 14px 40px rgba(37,99,235,0.12);
      border-color: var(--accent);
    }

    /* Better visible focus for keyboard users */
    input:focus-visible, textarea:focus-visible, select:focus-visible{
      box-shadow: 0 16px 48px rgba(37,99,235,0.14);
    }

    /* Placeholder transitions (subtle) */
    input::placeholder, textarea::placeholder{ color:#9aa3b2; transition: color .18s ease; }

    /* Disable motion for users who prefer reduced motion */
    @media (prefers-reduced-motion: reduce){
      input, select, textarea{ transition: none; transform: none; }
      input:hover, select:hover, textarea:hover, input:focus, select:focus, textarea:focus{ box-shadow: none; }
    }
    .row{display:flex;gap:8px}
    .row > *{flex:1}

    /* Fancy button styles (applies to all <button> elements) */
    button{
      position:relative;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:10px 12px;
      border:none;
      cursor:pointer;
      color:var(--btn-text);
      border-radius:var(--btn-radius);
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      background-size:200% 200%;
      box-shadow:var(--shadow-md);
      transform:translateZ(0);
      transition: transform .22s cubic-bezier(.2,.9,.3,1), box-shadow .22s, filter .22s, opacity .18s, background-position .8s;
      will-change: transform, box-shadow;
      outline: none;
    }

    /* Secondary variant keeps a darker theme but shares animation */
    button.secondary{
      background: linear-gradient(135deg,var(--dark),rgba(15,23,42,0.9));
      box-shadow: var(--shadow-md);
    }

    /* Decorative glow pseudo-element */
    button::after{
      content:'';
      position:absolute;
      left:-6px; right:-6px; top:-6px; bottom:-6px;
      border-radius:calc(var(--btn-radius) + 6px);
      pointer-events:none;
      opacity:0;
      transition: opacity .22s, transform .22s;
      transform:scale(.98);
      box-shadow: 0 30px 60px rgba(11,18,34,0.06), 0 8px 30px rgba(11,99,214,0.06);
      filter: blur(8px);
    }

    /* Hover / focus: lift and glow */
    button:hover, button:focus{
      transform: translateY(-5px) scale(1.02);
      box-shadow: var(--shadow-lg);
      filter:brightness(1.02);
    }
    button:hover::after, button:focus::after{ opacity:1; transform:scale(1); }

    /* Active/pressed feedback */
    button:active{
      transform: translateY(-2px) scale(.995);
      transition-duration:120ms;
      box-shadow: 0 10px 22px rgba(0,0,0,0.12);
    }

    /* Subtle animated gradient movement on hover */
    @keyframes gradientShift{
      0%{ background-position:0% 50%; }
      50%{ background-position:100% 50%; }
      100%{ background-position:0% 50%; }
    }
    button:hover{ animation: gradientShift 3.6s linear infinite; }

    /* Respect reduced-motion */
    @media (prefers-reduced-motion: reduce){
      button{ transition: none; animation: none; }
      button::after{ transition: none; }
    }

  .small{font-size:13px;color:var(--muted);margin-top:6px}
  .muted{color:var(--muted);font-size:13px}
    .list{max-height:240px;overflow:auto;margin-top:12px}
    .item{padding:8px;border-radius:8px;border:1px dashed #e6e9f0;margin-bottom:8px}
    .flex-between{display:flex;justify-content:space-between;align-items:center}
    .tags{display:flex;gap:6px;flex-wrap:wrap}
  .tag{background:var(--tag-bg);padding:6px 8px;border-radius:999px;font-size:12px;color:var(--accent)}
    .danger{color:#b91c1c}
    .success{color:#16a34a}

  /* Hamburger button - 3-line icon with fancy animations */
  .hamburger{
    width:52px;
    height:44px;
    background:linear-gradient(180deg,var(--card), var(--card-2));
    border-radius:999px;
    border:1px solid rgba(15,23,42,0.04);
    display:inline-flex;
    flex-direction:column;
    justify-content:center;
    gap:6px;
    padding:8px;
    cursor:pointer;
    align-items:center;
    box-shadow:0 8px 20px rgba(12,18,40,0.06);
    transition: transform .22s cubic-bezier(.2,.9,.3,1), box-shadow .22s, background .3s;
    will-change: transform, box-shadow;
  }

  /* Bars */
  .hamburger span{
    display:block;
    width:28px;
    height:3px;
    background:linear-gradient(90deg,var(--accent),var(--accent-2));
    border-radius:3px;
    transform-origin:center;
    transition: transform .36s cubic-bezier(.2,.9,.3,1), opacity .2s, width .28s;
    box-shadow: 0 6px 14px rgba(37,99,235,0.08);
  }

  /* Hover effects - shimmer and lift */
  .hamburger:hover{ transform: translateY(-3px) scale(1.02); box-shadow:0 18px 40px rgba(37,99,235,0.12); }
  .hamburger:hover span{ animation: barShimmer 1.2s linear infinite; }

  @keyframes barShimmer{
    0%{ filter: hue-rotate(0deg) brightness(1); }
    50%{ filter: hue-rotate(12deg) brightness(1.08); }
    100%{ filter: hue-rotate(0deg) brightness(1); }
  }

  /* Open state: transform into an X with subtle rotation */
  .hamburger.open span:nth-child(1){ transform: translateY(6px) rotate(45deg) scaleX(1.06); }
  .hamburger.open span:nth-child(2){ opacity:0; transform: scaleX(.8); }
  .hamburger.open span:nth-child(3){ transform: translateY(-6px) rotate(-45deg) scaleX(1.06); }

  /* Accessible focus ring */
  .hamburger:focus{ outline:4px solid rgba(37,99,235,0.12); outline-offset:4px }

  /* Drawer (slides from left) */
  .drawer{position:fixed;left:0;top:0;height:100vh;width:320px;background:linear-gradient(180deg,var(--card),var(--card-2));box-shadow:18px 0 40px rgba(12,18,40,0.12);transform:translateX(-110%);transition:transform .32s cubic-bezier(.2,.9,.3,1);z-index:70;padding:18px;display:flex;flex-direction:column}
  .drawer.open{transform:translateX(0)}
  .drawer-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  .drawer-body{display:flex;flex-direction:column;gap:12px}
  .drawer-item{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(90deg,var(--card-2),var(--card));box-shadow:var(--shadow-md)}
  .drawer-label{font-weight:600;color:#0f172a}
  .drawer-count{font-weight:700;color:var(--accent);font-size:20px}
  .drawer-overlay{position:fixed;left:0;top:0;width:100vw;height:100vh;background:rgba(6,8,23,0.32);z-index:65;transition:opacity .22s;opacity:0}

  /* Logo styles */
  .site-logo{display:inline-flex;align-items:center;gap:12px;text-decoration:none}
  .site-logo .mark{width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));color:white;display:inline-flex;align-items:center;justify-content:center;font-weight:800;font-size:18px;box-shadow:var(--shadow-md)}
    .site-logo .brand{display:inline-flex;flex-direction:row;align-items:baseline;gap:8px}
  .site-logo .brand .main{font-weight:800;font-size:22px;line-height:1;background:linear-gradient(90deg,var(--accent),var(--accent-2));-webkit-background-clip:text;background-clip:text;color:var(--accent)}
  .site-logo .brand .sub{font-size:16px;color:var(--muted);font-weight:700}

  /* Brand text: visible by default; animate class triggers a one-time entrance animation */
  .site-logo .brand{opacity:1;transform:none;}
  /* Slower, more visible entrance for brand text */
  .site-logo.animate .brand{opacity:1; animation:brandIn 1800ms cubic-bezier(.16,.9,.28,1) both;}
  /* main: long, very visible gradient sweep + noticeable scale float + subtle glow */
  .site-logo.animate .brand .main{animation:gradientShiftText 6000ms linear forwards 240ms, mainFloat 5000ms ease-in-out 240ms, mainGlow 1800ms ease-in-out 240ms; background-size:250% 250%;}
  .site-logo.animate .brand .sub{animation:subFade 2200ms cubic-bezier(.2,.9,.25,1) forwards 340ms}

  @keyframes brandIn{ from{ opacity:0; transform:translateY(8px) } to{ opacity:1; transform:translateY(0) } }
  @keyframes subFade{ from{ opacity:0; transform:translateY(6px) } to{ opacity:1; transform:translateY(0) } }
  /* pronounced gradient slide on the main word */
  @keyframes gradientShiftText{ 0%{ background-position:0% 50% } 40%{ background-position:60% 50% } 80%{ background-position:100% 50% } 100%{ background-position:80% 50% } }

  /* more visible scale float for the main word while the gradient sweeps */
  @keyframes mainFloat{ 0%{ transform: scale(1) } 50%{ transform: scale(1.12) } 100%{ transform: scale(1) } }

  /* subtle glowing burst early in the entrance */
  @keyframes mainGlow{ 0%{ text-shadow: 0 0 0 rgba(6,182,212,0) } 40%{ text-shadow: 0 10px 30px rgba(6,182,212,0.18) } 100%{ text-shadow: 0 0 0 rgba(6,182,212,0) } }

    /* Respect reduced-motion */
    @media (prefers-reduced-motion: reduce){
      .site-logo .brand, .site-logo.animate .brand, .site-logo .brand .main, .site-logo .brand .sub{ animation: none !important; transition: none !important; transform: none !important; opacity:1 !important }
    }

  /* Helmet logo: subtle float, gentle rotation and glow (slow & visible) */
  .mark svg{ display:block; width:34px; height:34px; }
  /* Image logo styling and entrance animation (slow, noticeable) */
  .logo-img{ display:block; width:34px; height:34px; object-fit:contain; border-radius:8px; }
  /* entrance animation for the image logo when .animate is added */
  .site-logo.animate .logo-img{ animation: logoImgIn 2200ms cubic-bezier(.16,.9,.28,1) both 160ms; }
  /* optional gentle float after entrance (very slow) */
  .logo-img.logo-float{ animation: logoFloat 8000ms ease-in-out infinite 2400ms; }

  @keyframes logoImgIn{
    0%{ transform: translateY(10px) scale(.92) rotate(2deg); opacity:0; filter:blur(2px); }
    60%{ transform: translateY(-10px) scale(1.12) rotate(-3deg); opacity:1; filter:blur(0); }
    100%{ transform: translateY(0) scale(1) rotate(0deg); opacity:1; filter:blur(0); }
  }

  @keyframes logoFloat{
    0%{ transform: translateY(0) rotate(0deg); }
    50%{ transform: translateY(-6px) rotate(-2deg); }
    100%{ transform: translateY(0) rotate(0deg); }
  }

  /* Respect reduced-motion preference */
  @media (prefers-reduced-motion: reduce){
    .site-logo.animate .logo-img, .logo-img.logo-float{ animation: none !important; transform:none !important; }
  }

  </style>
</head>
<body>
  <div style="max-width:1100px;margin:0 auto 18px;">
    <h1 class="logo-heading" style="margin:0 0 8px">
      <a class="site-logo" href="#" aria-label="Labour Link">
        <span class="mark" aria-hidden="true">
          <!-- Image logo: replace SVG with LL.jpg (falls back to text if image missing) -->
          <img src="LL.jpg" alt="Labour Link logo" class="logo-img" />
        </span>
        <span class="brand"><span class="main">Labour</span><span class="sub">Link</span></span>
      </a>
    </h1>
    <div class="muted"><code></code> <code></code> </div>
  </div>  <div class="container">
    <!-- Hamburger menu (top-left) -->
    <button id="menuBtn" class="hamburger" aria-label="Open menu" aria-expanded="false" title="Menu" style="position:fixed;left:18px;top:18px;z-index:60">
      <span></span><span></span><span></span>
    </button>

    <!-- Side drawer (hidden by default) -->
    <div id="sideDrawer" class="drawer" aria-hidden="true">
      <div class="drawer-header">
        <strong>Overview</strong>
        <button id="closeDrawer" aria-label="Close" title="Close">✕</button>
      </div>
      <div class="drawer-body">
        <div class="drawer-item"><div class="drawer-label">Companies</div><div class="drawer-count" id="companyCount">467</div></div>
        <div class="drawer-item"><div class="drawer-label">Workers</div><div class="drawer-count" id="workerCount">3649</div></div>
      </div>
    </div>
    <div id="drawerOverlay" class="drawer-overlay" style="display:none"></div>
    <div>
      <div class="card" id="workerCard">
        <h2>Worker Registration / Login</h2>
        <div id="workerAuth">
          <label>Mobile number</label>
          <input id="wMobile" placeholder="10-digit mobile" />
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="sendOtp">Send OTP (simulate)</button>
            <button id="loginWithPwd" class="secondary">Login with Password</button>
          </div>
          <div id="otpBox" style="display:none;margin-top:8px">
            <label>Enter OTP</label>
            <div class="row">
              <input id="wOtp" placeholder="6-digit" />
              <button id="verifyOtp">Verify</button>
            </div>
            <div class="small">OTP will be shown in an alert (simulation). Timer 90s.</div>
          </div>
        </div><hr style="margin:12px 0">

    <form id="workerForm">
      <label>Full name</label>
      <input id="wName" required />

      <label>Aadhaar number (will be masked)</label>
      <input id="wAadhaar" maxlength="12" placeholder="123412341234" />

      <label>Country</label>
      <select id="countrySelect"><option>Loading countries...</option></select>

      <label>State (auto for India; else manual)</label>
      <select id="stateSelect" style="display:none"></select>
      <input id="stateInput" placeholder="State / Province" />

      <label>District / City</label>
      <input id="districtInput" placeholder="District or city" />

      <label>Present Address</label>
      <textarea id="address" rows="2"></textarea>

      <label>Worker category</label>
      <select id="category">
        <option>Electrician</option>
        <option>Mechanic</option>
        <option>Labour</option>
        <option>Plumber</option>
        <option>Carpenter</option>
        <option>Others</option>
      </select>
      <!-- hidden textbox shown when user selects Other/Others -->
      <input id="categoryOther" placeholder="If Others, type here" style="display:none;margin-top:8px" />

      <label>Degrees / Qualifications (comma separated)</label>
      <input id="degrees" placeholder="e.g. ITI Electrician, Diploma" />

      <label>Work experience (years)</label>
      <input id="experience" type="number" min="0" value="0" />

      <label>Password</label>
      <input id="wPassword" type="password" />
      <label>Re-type Password</label>
      <input id="wRepass" type="password" />

      <div style="display:flex;gap:8px;margin-top:12px">
        <button id="saveWorker">Complete Worker Account</button>
        <button type="button" id="clearWorkers" class="secondary">Clear All Workers</button>
      </div>
    </form>

    <div class="small" style="margin-top:10px">After registration, workers are listed on the right and companies can assign workers.</div>
  </div>

  <div class="card" style="margin-top:14px">
    <h2>Company Registration</h2>
    <label>Company name</label>
    <input id="cName" />
    <label>Company address</label>
    <input id="cAddress" />
    <label>GST Number</label>
    <input id="cGst" />
    <label>Type of work / Need</label>
    <input id="cWork" placeholder="e.g. Need 5 electricians" />

    <div style="display:flex;gap:8px;margin-top:12px">
      <button id="saveCompany">Save Company</button>
      <button id="clearCompanies" class="secondary">Clear Companies</button>
    </div>

    <hr style="margin:12px 0">
    <h3 style="font-size:15px;margin:0 0 8px">Assign worker to company</h3>
    <label>Select company</label>
    <select id="companySelect"></select>
    <label>Select worker</label>
    <select id="assignWorkerSelect"></select>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button id="assignBtn">Assign</button>
    </div>
  </div>
</div>

  </div>  <script>
    // --- Utilities ---
    const $ = id => document.getElementById(id);
    const storageKey = {workers:'demo_workers_v1', companies:'demo_companies_v1'};

    // --- Country fetch ---
    async function loadCountries(){
      try{
        const res = await fetch('https://restcountries.com/v3.1/all');
        const data = await res.json();
        const list = data.sort((a,b)=> (a.name.common > b.name.common?1:-1));
        const sel = $('countrySelect'); sel.innerHTML = '';
        list.forEach(c=>{
          const opt = document.createElement('option'); opt.value = c.cca2 || c.name.common; opt.textContent = c.name.common; sel.appendChild(opt);
        });
        // set default to India if present
        for(let i=0;i<sel.options.length;i++) if(sel.options[i].text==='India') sel.selectedIndex=i;
        handleCountryChange();
      }catch(err){
        const sel = $('countrySelect'); sel.innerHTML = '<option>India</option><option>United States</option><option>Other</option>';
      }
    }

    // Sample states for India; for other countries we allow manual entry
    const indiaStates = ["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Delhi"];

    function handleCountryChange(){
      const c = $('countrySelect').selectedOptions[0].text;
      if(c==='India'){
        $('stateSelect').style.display='block'; $('stateInput').style.display='none';
        const ss = $('stateSelect'); ss.innerHTML=''; indiaStates.forEach(s=>{ const o=document.createElement('option');o.value=s;o.textContent=s;ss.appendChild(o);});
      } else {
        $('stateSelect').style.display='none'; $('stateInput').style.display='block';
      }
    }

    // --- OTP Simulation ---
    let currentOtp = null; let otpExpiryTimer = null;
    function sendOtp(){
      const mobile = $('wMobile').value.trim();
      if(!/^[6-9]\d{9}$/.test(mobile)) return alert('Enter valid 10-digit mobile starting 6-9');
      currentOtp = Math.floor(100000 + Math.random()*900000).toString();
      alert('SIMULATED OTP for '+mobile+': ' + currentOtp + '\n(This is a demo — OTP shown in alert)');
      $('otpBox').style.display='block';
      if(otpExpiryTimer) clearTimeout(otpExpiryTimer);
      otpExpiryTimer = setTimeout(()=>{ currentOtp=null; }, 90*1000);
    }
    function verifyOtp(){
      const val = $('wOtp').value.trim();
      if(val===currentOtp){
        currentOtp = null; if(otpExpiryTimer) clearTimeout(otpExpiryTimer);
        // allow form filling — prefills mobile
        alert('Verified! Now fill the rest of worker details and choose a password.');
      } else alert('Wrong OTP or expired.');
    }

    // --- Persistence ---
    function loadWorkers(){
      const raw = localStorage.getItem(storageKey.workers) || '[]';
      try{ return JSON.parse(raw);}catch(e){return []}
    }
    function saveWorkers(list){ localStorage.setItem(storageKey.workers, JSON.stringify(list)); renderWorkers(); }
    function loadCompanies(){ const raw = localStorage.getItem(storageKey.companies) || '[]'; try{return JSON.parse(raw);}catch(e){return []} }
    function saveCompanies(list){ localStorage.setItem(storageKey.companies, JSON.stringify(list)); renderCompanies(); }

    function maskAadhaar(s){ s = (s||'').toString(); if(s.length<12) return s; return s.slice(0,4) + ' **** ' + s.slice(-4); }

    // --- Render ---
    function renderWorkers(){
      const list = loadWorkers(); $('workerCount').textContent = list.length;
      const wrap = $('workerList'); wrap.innerHTML='';
      const select = $('assignWorkerSelect'); select.innerHTML='';
      list.forEach((w,idx)=>{
        const div=document.createElement('div'); div.className='item';
        div.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${w.name}</strong> <span class="muted">(${w.category})</span><div class="small">Mobile: ${w.mobile} | Aadhaar: ${maskAadhaar(w.aadhaar)}</div></div><div><button data-idx="${idx}" class="btnView">View</button></div></div>`;
        wrap.appendChild(div);
        const opt = document.createElement('option'); opt.value = idx; opt.textContent = w.name + ' — ' + w.mobile; select.appendChild(opt);
      });
      // attach view buttons
      document.querySelectorAll('.btnView').forEach(btn=>btn.addEventListener('click',e=>{
        const i = btn.getAttribute('data-idx'); const w = loadWorkers()[i]; alert(JSON.stringify(w, ['name','mobile','category','degrees','experience','address'], 2));
      }));
    }

    function renderCompanies(){
      const list = loadCompanies(); $('companyCount').textContent = list.length;
      const wrap = $('companyList'); wrap.innerHTML='';
      const csel = $('companySelect'); csel.innerHTML='';
      list.forEach((c,idx)=>{
        const div=document.createElement('div'); div.className='item';
        const ass = (c.assignedWorkers||[]).map(i=>{ const w = loadWorkers()[i]; return w? w.name : ('#'+i); }).join(', ');
        div.innerHTML = `<strong>${c.name}</strong><div class="small">GST: ${c.gst || '-'} | ${c.work}</div><div class="small">Assigned: ${ass || 'none'}</div>`;
        wrap.appendChild(div);
        const opt = document.createElement('option'); opt.value = idx; opt.textContent = c.name; csel.appendChild(opt);
      });
    }

    // --- Events ---
    document.addEventListener('DOMContentLoaded',()=>{
      loadCountries();
      $('countrySelect').addEventListener('change', handleCountryChange);
      $('sendOtp').addEventListener('click', sendOtp);
      $('verifyOtp').addEventListener('click', verifyOtp);
      $('saveWorker').addEventListener('click', e=>{
        e.preventDefault();
        const mobile = $('wMobile').value.trim();
        const name = $('wName').value.trim();
        if(!name) return alert('Enter name');
        if(!/^[6-9]\d{9}$/.test(mobile)) return alert('Enter valid mobile');
        const pwd = $('wPassword').value;
        if(pwd.length<4) return alert('Password should be at least 4 chars (demo)');
        if(pwd !== $('wRepass').value) return alert('Passwords do not match');
        const country = $('countrySelect').selectedOptions[0].text;
        const state = $('stateSelect').style.display==='block' ? $('stateSelect').value : $('stateInput').value;
        const worker = {
          name, mobile, aadhaar: $('wAadhaar').value.trim(), country, state, district: $('districtInput').value, address: $('address').value, category: $('category').value, degrees: $('degrees').value.split(',').map(s=>s.trim()).filter(Boolean), experience: Number($('experience').value||0), password: pwd
        };
        const workers = loadWorkers(); workers.push(worker); saveWorkers(workers);
        alert('Worker saved (demo).');
        document.getElementById('workerForm').reset();
      });

      $('clearWorkers').addEventListener('click', ()=>{ if(confirm('Clear all workers?')){ localStorage.removeItem(storageKey.workers); renderWorkers(); }});

      $('saveCompany').addEventListener('click', ()=>{
        const name = $('cName').value.trim(); if(!name) return alert('Enter company name');
        const c = {name, address: $('cAddress').value, gst: $('cGst').value, work: $('cWork').value, assignedWorkers: []};
        const list = loadCompanies(); list.push(c); saveCompanies(list); alert('Company saved'); document.getElementById('cName').value='';
      });

      $('clearCompanies').addEventListener('click', ()=>{ if(confirm('Clear all companies?')){ localStorage.removeItem(storageKey.companies); renderCompanies(); }});

      $('assignBtn').addEventListener('click', ()=>{
        const ci = $('companySelect').value; const wi = $('assignWorkerSelect').value;
        if(ci===''||wi==='') return alert('Select company and worker');
        const comps = loadCompanies(); if(!comps[ci].assignedWorkers) comps[ci].assignedWorkers=[]; comps[ci].assignedWorkers.push(Number(wi)); saveCompanies(comps); alert('Assigned'); renderCompanies();
      });

      // initial render
      renderWorkers(); renderCompanies();

      // Trigger logo brand animation once on initial load (skip for reduced-motion)
      try{
        const logoEl = document.querySelector('.site-logo');
        const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        if(logoEl){ if(!prefersReduced) setTimeout(()=> logoEl.classList.add('animate'), 120); else logoEl.classList.add('animate'); }
      }catch(e){/* ignore */}
    });

    // Drawer toggle logic
    (function(){
      const menu = $('menuBtn'); const drawer = $('sideDrawer'); const overlay = $('drawerOverlay'); const close = $('closeDrawer');
      if(!menu || !drawer) return;
      function openDrawer(){ drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); overlay.style.display='block'; setTimeout(()=>overlay.style.opacity='1',20);
          // show requested fixed counts per user
          const wc = $('workerCount'); const cc = $('companyCount'); if(wc) wc.textContent = '3649'; if(cc) cc.textContent = '467';
          menu.classList.add('open'); menu.setAttribute('aria-expanded','true');
        }
        function closeDrawer(){ drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); overlay.style.opacity='0'; setTimeout(()=>overlay.style.display='none',240); menu.classList.remove('open'); menu.setAttribute('aria-expanded','false'); }
      menu.addEventListener('click', ()=>{ if(drawer.classList.contains('open')) closeDrawer(); else openDrawer(); });
        if(close) close.addEventListener('click', closeDrawer);
        overlay.addEventListener('click', closeDrawer);
        // close on Escape
        document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && drawer.classList.contains('open')) closeDrawer(); });
    })();

    // --- Small handler: show 'Other' textbox for category and sync value ---
    document.addEventListener('DOMContentLoaded', ()=>{
      const cat = $('category');
      const other = $('categoryOther');
      if(!cat || !other) return;

      // helper: add or update a custom option to hold the typed value
      function upsertCustomOption(val){
        if(!val) return;
        let custom = Array.from(cat.options).find(o=>o.dataset && o.dataset.custom==='1');
        if(custom){ custom.value = val; custom.text = val; }
        else { custom = document.createElement('option'); custom.value = val; custom.text = val; custom.dataset.custom='1'; cat.appendChild(custom); }
        cat.value = val;
      }

      function showHide(){
        const txt = (cat.selectedOptions[0] && cat.selectedOptions[0].text) || '';
        // treat both "Other" and "Others" (or any label containing 'other') as the trigger
        if(txt.toLowerCase().includes('other')){
          other.style.display = 'block'; other.focus();
          if(other.value.trim()) upsertCustomOption(other.value.trim());
        } else {
          other.style.display = 'none';
        }
      }

      // when user selects category
      cat.addEventListener('change', showHide);

      // when user types their custom category, keep select in sync so existing save handler reads it
      other.addEventListener('input', ()=>{
        const v = other.value.trim();
        if(v) upsertCustomOption(v);
      });

      // initial state
      showHide();
    });

  </script></body>
</html>
